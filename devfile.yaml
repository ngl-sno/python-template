schemaVersion: 2.2.2
metadata:
  name: python-hello-world
components:
  - name: python
    container:
      image: registry.redhat.io/devspaces/udi-rhel9:3.18
      volumeMounts:
        - name: venv
          path: /home/user/.venv
      memoryLimit: '2Gi'
      memoryRequest: '1Gi'
      cpuLimit: '2'
      cpuRequest: '1'
      mountSources: true
  - name: venv
    volume:
      size: 1G
commands:
  - id: run
    exec:
      label: "Run the application"
      component: python
      workingDir: ${PROJECTS_ROOT}/python-template
      commandLine: python -m venv .venv && . .venv/bin/activate && python hello-world.py
      group:
        kind: run
  - id: copyconfig
    exec:
      component: python
      commandLine: "cp -p /etc/secret/continue-config-secret/.continuerc.json /home/user/.continue/config.json"
events:
  # preStart:
    # - copyconfig
  postStart:
    - copyconfig
  # preStop:
  #   - command3
  # postStop:
  #   - command4  

#   - id: copyconfig
#     exec:
#       component: python
#       commandLine: "[[ ! -d /home/user/.continue ]] && mkdir /home/user/.continue && cp /projects/python-template/.continue.example/config.json /home/user/.continue/config.json"
# events:
#   postStart:
#     - copyconfig